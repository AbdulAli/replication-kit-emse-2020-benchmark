import java.io.File;
import java.io.IOException;

public class FlattenConfigurations {


    public static void main(String[] args) throws IOException {

        //File dir = new File(System.getProperty("user.home") + "/Desktop/CMPUT663/663Dataset");
        listFilesForFolder(new File(System.getProperty("user.dir")+"/Configurations/"));
    }

    /**
     * This function parse the dataset generated by configurations and create a single file for all folders
     * Uncomment fileEntry.renameTo(newName); before execution
     * @param folder
     */
    public static void listFilesForFolder(final File folder) {
        for (final File fileEntry : folder.listFiles()) {
            if (fileEntry.isDirectory()) {
                listFilesForFolder(fileEntry);
            } else {
                if(fileEntry.isFile() && !fileEntry.isHidden()) {
                    File newName;
                    ///Users/abdulalib/Desktop/CMPUT663/HMWorkspace/crosspare-src/benchmark/data/Configs/Configuration2_ResultsIC/DataK=13/18test.csv
                    String filePath = fileEntry.getAbsolutePath();
                    String configuration = filePath.split("/Configurations")[1].split("_")[0];
                    String window = filePath.split("DataK=")[1].split("/")[0];
                    String timeSplit = filePath.split("DataK="+window+"/")[1].split("t")[0];

                    if(filePath.contains("typetest")) {
                        String type = filePath.split("DataK="+window+"/")[1].split(timeSplit)[1].split("_project")[0];
                        String project = filePath.split("DataK="+window+"/")[1].split(type+"_project")[1].split(".csv")[0];
                        newName = new File(System.getProperty("user.dir")+"/AllConfigs/"+configuration + "_" + "window"  + window + "_" + "split" + timeSplit + "_" + "type" + type + "_" + "project" + project + ".csv");
                    }else {
                        String type = filePath.split("DataK="+window+"/")[1].split(timeSplit)[1].split(".csv")[0];
                        newName = new File(System.getProperty("user.dir")+"/AllConfigs/"+configuration + "_" + "window"  + window + "_" + "split" + timeSplit + "_" + "type" + type + ".csv");
                    }

                    fileEntry.renameTo(newName);
                }

            }
        }
    }

}

